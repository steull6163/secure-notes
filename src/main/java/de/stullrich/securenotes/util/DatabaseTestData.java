package de.stullrich.securenotes.util;

import com.dracoon.sdk.crypto.Crypto;
import com.dracoon.sdk.crypto.CryptoUtils;
import com.dracoon.sdk.crypto.FileEncryptionCipher;
import com.dracoon.sdk.crypto.model.*;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.stereotype.Component;

import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;
import java.io.IOException;

@Component
public class DatabaseTestData {

	private static final Logger logger = LoggerFactory.getLogger(DatabaseTestData.class);
	private static final String USER_PASSWORD = "1234567890";
	private static final String[] KEY_TYPES = {"private", "public", "fKey"};
	private static final EncryptedFileKey[] FKEYS = new EncryptedFileKey[3];
	private static final String[] CLEARTEXTS = {"The General Data Protection Regulation says: Personal data should no longer be able to be attributed to a specific data subject without additional information, provided that this additional information is kept separately and is subject to technical and organisational measures which ensure that the personal data is not attributed to an identified or identifiable natural person. The measures shall take into account the state of the art, the implementation costs as well as the type, scope, circumstances and purpose of the processing. In addition to these criteria, the different probabilities of occurrence and the severity of the risk to the rights and freedoms of the data subjects must also be taken into account. Accordingly, the level of security measures taken should be adapted. Encryption is explicitly mentioned as such a measure in the non-exhaustive catalogue of Art. 32. You must report a data breach if it poses a risk to the data subject. According to Art. 4 No. 12 GDPR, a violation of personal data exists if personal data have been lost or have been destroyed, altered or disclosed without authorisation. The supervisory authorities shall ensure that the fines provided for in the article for infringements of the GDPR are effective, proportionate and dissuasive in each individual case.",
			"Encryption is a form of pseudonymisation. The key stands for the additional information. If the key is kept together with the data, encrypted data can be made publicly accessible, e.g. in the event of a phishing attack. Pseudonymisation is then no longer possible. In order to ensure adequate protection, personal data should be encrypted. However, not all types of encryption provide the same level of protection. For maximum security, encryption keys should be controlled by the user. No one else should have access to them during the encryption and decryption process. In the event of a data protection breach, the responsible person must report the breach to the competent supervisory authority without delay and, if possible, within 72 hours of becoming aware of the breach. Unless the breach is unlikely to create a risk to the protection of personal data. Fines are imposed according to the circumstances of the individual case. In deciding on the imposition and the amount thereof, account shall be taken in each individual case of the measures taken.",
		    "With client-side encryption there is no possibility to decrypt the files on the server, e.g. in case of a phishing attack, because only encrypted key material is stored there. The key that encodes the data never leaves the user''s computer in plain text. If client-side encryption is used, it is impossible to decrypt the files in case of an attack on the server, because the key is held by the owner. Therefore, hacks on servers are not considered as data mishaps and the notification rules of the GDPR do not apply. This means that you save the cost of data failure notifications and possible fines, maintain your reputation and protect the privacy of your employees and customers. Since all files are encrypted on the user''s end device, only unreadable data can be known. These are not considered personal data or data mishaps. Fines are therefore avoided."};
	private static final String[] TITLES = {"What the GDPR says", "What that means", "client-side encryption helps"};
	private static final String[] NOTES = {"{\"v\":\"hybrid-crypto-js_0.2.4\",\"iv\":\"ZbduQm5wrtwVMRCBxfrCYH1VZzlfuEw/9ek2UsVeIb4=\",\"keys\":{\"bb:b1:c2:6c:06:85:7d:70:35:8b:f5:57:fc:d5:6d:3e:d0:0d:3b:c5\":\"F69RxvZSEdSaxuO8rflWMM8pvbns/KyYoRf1Nwu8ACFcpITBRVVeVZppobTcSU7JR/Xd+sZnq/i/gnMwRH3F+vYd28+Dxz9/zPhQcyhvNr3oQwzcosTgpCSG6ixyQMXFoL9vSAmDhbyWsvl0Rdz9soZOycdj2j5X/VBJ+2R5fCuAJIOND3imoaV1NqPj9PGNrLsoGdnB2IsCs3L2/GgIALyvhbg6qDkcZt0rb10+a2iKUZpBXDL9iGgLQlpAI0gk4a8QrsXYGACw1GRX8F5DP3+NOroLHB4AT1nKfZZZt6P2Jk+XWQCwMwv3mQfZkUne47umZ0SnhlCoGjwDz2R5jtU+aAD2qslSevAXPYmOd8JWq70NuJFnacduZsKtHO0WwvMXFGikLa28Um/Kkz2HTCDL1kof58NaHzqZ1k8L03W82RYn4LVN6f14upzkiBvjWhj2rmpfKble8WLGXxj2rl4XknfRCckj/wg7jpeC7meLfy7WiHSSz6TZPgYKLLCkoy6cwDNbAPxg8FJ6V+/sOTk9VeEzjSmC1AM2Lp+bfy95NBN9HFdpLHt1jlELpAnRPZtCyEQt3oa/6pj6aKyZqw7+sezkpKS3FDsZ0L7A5HDaKCh7oi6w6p9JMp5m5+jF9u99YDVKjvus1Fcbf6gbViL3H2jHJPWz31TvXs87spc=\"},\"cipher\":\"Odv45QI6uVC1UEu/EimadUty9E3KBWQFOUb9HAoVKzdtpa0NGrJowOP8Bud3cDLLdHxgeHklN1JUYW9xTtjx4vykxwx+lpLw1AjE6kiH6jZuZ/ZBd7GfKWfRPvORF/TCPi5HU2oHAiNwDSTXlY6RqB5tOlHcQqaf7LvR0SQLSVGpZvkY5kwqPzRiBkp/RoWuHjpVDv1EF4ojlSQdb4FGGyyv9IDiZ5zk2hm8c+BCPGqGnbNLqWJvDZRgwLpANE4tHHguE7XOtGTctSTSKhtictqpgSa0e/I6PEpR5NSMHhTzOA0p5YnvEvI0eH8QE7QL5q7yyjsYoZE60qstaABrTVA8q+pHtFzRhadtlN/cK2hpi/l6fR9MNzruSvrVyvYRABqkxH3q7oHzDLxReRoy61Nm7YG6whwNMlnu02oWG51QXfJaiOr0YZ0spwAsUxa4/jhyRgOyrbJtbYSDnTzmDaGTJnrUO7hJjPyFE4PNHqZF43w6Gb5yQD5EGrW8E+pby24v1dimkNZJCdoWIZg48pyKvs1uMP7+uftXXCBtMdM+UnLzghM/n8YK+oKdTJxfu8h19jkm77vP8FgBQmPX2IMu12GeR08FqMUOs8C2VvXaZT6SeDWrrDFUiTQf7ElbcBrffFmhrobshvAgQVn8huXyw7JlGBjcNpQpFd20VyMEQlFB7BsA/TOQCf69EHs9P8+TGZktTeYf4woP5TVcKY6UcSDM3PiUqjnV+YR5xlcJTeecftXadoNo1v/Uq6Q2S6wgIOt5msYfU2YGuLD3Pc3fZG1lSSjsPJvM91L0B/EQG2hr1Zh27LZ1H/IgZ51sHu3D1ZxTAmu8bMISEZgkavpytWzHwkh0LPQmWr8FwCA5tG1S/N6AgeBAZdPaN4n/bF1sUc025/7I8bkxY9lFjhBbhWJFXec6CiZjogewOmA/l+3y6TydGoGwfMzoRy42etmXyfze3oxSR5r/Cw3gYvee/JTAAdG5vjX6wPP5GxReBwhHS6+69EvBoeYDge0FPgJB5RP2CzgEWueoFmiXRLnIlOayaVGriczF0lxUXe7DFveQdgO9chm4aqnGBjWk1nx2GGCD/cSH2Vv2Q4oCmPX8alu+UEpTth1n8zPeu86HyHtSsrW3MbNcPBrvwDXj+EU+esg7hYGA2ESrr0bkaTDQc4w9E2Ap9XN9rXptUq3GkImGK07MsRHRm68SCCGCLWqMNsdlHBQoeAkjCoE1TQAFCXis17II+rM7gEzx/A49UvMxod6+bPW5WmolqzbcQqSanUMu/z4t8/MGlQ5tqV7sFOVuhCbHR9YJu94zaGbERQvRK0ryOGqkRouaCUNN4M2SdQ5Ws6W/TkvlsyQuADKSHNynRcDPkvYcRRR+2NKezddQc+1o4XMk7LsYgohtZgOIKAVfxn75gnV5rCrTjeERbxSDfeYQs6mmy6/P9E0bBwnrMFhter5eJR676R26eavsybbaJytq7otvuUYrjLDAr/R84LFyF0DXq8TSa7DSHhtmBVkefU8kKCErBzpAm7DPGOzuLmk5g2EaQaIG9BME3Q8nAT53WJxisqQ5d41+KgY9PSPsQqwcoO0o3d8JqHXgOtuihJe57Mm/i9rf66WUkLZ7iRb+LcfW41aSmQksVTMpmRRDF1lpewrcaD89qGH4w405U3Kq3qs2liObq9ndxqJNnNQsr5BvCaY8zcHnUVBBBLUDN4dQFSShIAUANQYK9RlVl4KwmFB4b0/83A==\"}",
			"{\"v\":\"hybrid-crypto-js_0.2.4\",\"iv\":\"OORBT9coiugtOHnNhihk38zjupcyXmxskRjxPi9S4js=\",\"keys\":{\"bb:b1:c2:6c:06:85:7d:70:35:8b:f5:57:fc:d5:6d:3e:d0:0d:3b:c5\":\"km/qW7DHOVeW4LBWKSU6cFt/cKIR/+mz4326KFe78aPmv6PrfK6lI1g/Q608G3Tgz7mygO7KGmNxpvr1C+Qa+2KhWJ8OnQgV4PAAz7dHaFcDCNiR5NqjhOUfzeIPjBOf7CzieyuYy4k0jGg2VCHNcq0rmWGMJ25jwxef4EVs5Drov4I9ZpwyuaEjNYanshXjjmR+30/DqGj+nyiCWL6kMTQqmo39K8LKeX65sW0ZYD5IA0+ZIHKnzfsz9Ys9nqPXpXVD89nvmXzrujrBDyzR1cNlP3fmiDrD0JRgi64kejFN6Z/f8VSgy51JyH6f8UTD9MqjiO8wqW3uwKek4okYL4vH3PP0Lfytlns0b+IhrGRQldB2XaBqlOO/UAhDBKsCHn0yP8vHDemuW3nn23iRAzPSpcAjjwArOYYhFj7UcbZTdxzMj3lo0ya3uzQBm8ikFhQfYAc5tiHoYI+dDGvXSkTuHVWnEZX81W8ncPigPgXJ24lPkNbxZ0iv+vR1mS7NqjsjVieO2hTIVBv+GA3LI63hr9oibfkB8yGKgz4xvdG5Y9DGV6GlCQ25gCUswMbrG41DMLuRqvDugRd+Rzq9r/b66fY7Hsr3biMn1lfRb2oZT++JidiPnU9ZWkiyb2jpkQFvRhJOn+9CVPD8mV57dhvc7rhTHOtAJynrSTvP9w0=\"},\"cipher\":\"Myr4/vO9kcpuYB+eKmpoEO5NSMs3JeTIO3SbUgZ+bB9EC8dROGMctasJeaIKvjXBBAvDEuTJFQC3AFRfCryohjyGDeGUEqchSqkk2sFU+GxKx6Fxm8DTX10fHp7mgaASFW+GrQI1Hyjd+gibUFycvvyyda8rp+kxMiAI3hrNb70mRGQ0zVJQBXRTilkKQra8lJZRwTp12P+eC5o6dy/t11vRqsvAC7vkjdbJhi5DRW00fCi6UcLnPRaZXT3yb4TRSOlaOrR/WHneJq//Qw9bTgWQlEQ3Z2IPzqa1rkzAatQnxeqi2/jusFgdHOiw8x7ztraoOCbk027A9Hy3D1MinMQemn54C4a+Gyqn2vIeOwO5f9Y9AX9QmaDx++O1MLOQgHWKB2LYuOSnV/mdy8+Wa7IfOY7qJJKn/YMNLHET0MTXOwH7seK/InWYbD3Ch4PjwwpHSbFHUIKt40RZPBGf97MfiBmJf4eZaErGeYpssA5DLZEsJRRrafb8tSf3G1bU/jWDXNhn4fM/ZRgJddip8HAIgz4nCPcgfcAwVufGqgW71h6qsRz9I/NUTKZWheO735hF9rp/WaBK1Hdg+Y6tNWLeeny8UDv5NA8qRHrjLEaBTbIfsJTA5Y8yEsRKNEUQixNMCYXdoXWRg0imwRC7pRkvhHL7DFUvNAVZAvTuomEfOiwNhNy8jwncN/RvuZ74l7RCeKcyCWYc8gsDuHULfKvFfwjrK+J9yEOqRxqGopiKe25+QUX7AdHXc2c81+uxhwVzi7Tl+zAn5LRGJvozM0jFtmBe+t2eQ4i/xMDotzp9QFUUocP7BiwnguRLehL5DqDgvKU1Y3HAEvCJzQ4Uh/rwlFvcTW6V0VMC4g8ylUi7YvSGjz1gCXq8hD9LlDMkKu8exxD3rGiIl2gxMQpfDM5sr3SZXEkBNLP6F32DLI1v71/zvqvrFGH2grE/baGIF8q1eJBvFj7V09kJr2x4jVTS7dGYE3d0mo3WV7LY/WyLFvhr7qLYT4dvQZAzNbuIEqChrk64xmtv+YRBYaPxbcZLfjfBacxBaCoitrDbr1NFEPgBP2qB+aCMgXLHY7X5XjE4xzQ6Ti1Ib5TGbU3fvYHyYka/F8xHkgh7CBnETSncyIwAfJlghfjF9pAWTq7ja8xZmHEiqYXesQN47nd/BVusG8lEBGpXs/bxhBdBN0Wka4Kg5eUKr90nnSIMht1IbV1I9ZlLLsuJHmQXnXg3Tk3xbo1vT8GhFoC+gZTZSRqg7YHBn29xQODOaQ+HReahnNm/tdRPFB7X+rsWYqg5QE5b035P7vJoMgnJDWmSLHd+6p5BkBueR2wdlZ0piOtE3hGyt7X1RKx3Mv4AEzN86rcWEi2mjWDOaA+UHH9DTwZRH6Ouu9nzuFVbLZfoh/7KxhuqJpfatolcyMrEgIl92g==\"}",
			"{\"v\":\"hybrid-crypto-js_0.2.4\",\"iv\":\"t1rnBWYAenHiVuj1bc/CyKR1OAIntZUOcM7pRQg9DN0=\",\"keys\":{\"bb:b1:c2:6c:06:85:7d:70:35:8b:f5:57:fc:d5:6d:3e:d0:0d:3b:c5\":\"IIe1aCt7eqShxj6g7y+tk4Mo4fVC9mrphqNiIAhR8qWJ0TuG0oRtK+pflJuYuthnsaROw8la745qrwJQ0yoEczYGeiHDKL7sIRcVFPGH3pzZ/3ETVxT/t4IDGjdzG0fna1ayb9brpg1bvueOBcne26itMs5bhrCs4w/1Sy76IeYGhFOA0XNs6ZXM3f7dHrIkTBH6s6f6a+VxZiqhzP+thTqPmxrBr5qd5fVcw6Wha7nal/rVt2nHOF0fMmol4LhdOwg6IOn/rPnPt04PAgRB66UV3DyiJECP4yzJIsv+YB6rOYwRJdU1kF2S4PDfEda1cFV9pjaQzAXToRrk0DAzwPeosz/D/uiotmbxzIOB0A8tvYks2vKCcHenErPVBJ5Gfm0Q8x5JV+Dy2nbgdyISHiymIgBR4kZnMttx/YYlfC9QlWcUT1+9kXAEVkrlgcrdIbR/M4VIonZDZ4T18sLvgX7VKb+2jgb1XlkhV5ZyJZXfDOfJKj76dRtk98EKi7DLVPdU7tHviPDzaCUEwodulIe6Eo9QtneQD+cmvMT8rSV/0EcntSZuNR75MpUPMp3qtJ8PNUtVy9apJFlHeVsi50WTxMkMpBrbn9AjcND/5kPxUhAiL0R+U9iOuIneCVSFOBx/zGvTD27eFEgT3gqH3p3m4aONq1igAvRD3jI6UkQ=\"},\"cipher\":\"j9lj3zf+xu22IEyoa2rS4FQbc+geHi9g9i4sWcX4SNz9uSleZscIDHLmkFMSIu6IQBRjvfhZ6MHkGGgeWWlxvi3FAEV7rYnyAkOxHpmdmDYzirKZvvAvadlY43T/xBZAPA2GyM5W+y+HAYSQKNsE1GHTcr9KUAMUTxurlJH/UEe3bdywP+Yu5yhEGfj/5KTHaV0CMA6+lmHujcCJBxSQe827xVkT2V7AiPkED+Ha/nMWVdDiQExt0aA0tDxA+OYOA/9+6rhMuY/z42I3t84Fg/7ZVaom41o932ZsB8imJehsJY/dqNf7TzH4N1Nwzg1OpHmTeejUzFXfIrR1TNOvc0KsvA/hcZnibSb8sIHTuhh2p/t11KDqXNHc2ZGhSpHcdAet++Ki8rRqoJ7Voy61zZydqnrE7xKikOJLkJZJ1xTbG2j93UTXw1i9UiH8ylk15GdJfyX5OYNXUi8NagBK4R1sxIgvtnFDj9Q5OzLfdkKuHxErJuoLuKiCthO0WiYPtw5VG6VtpuSRuv3bRCNW76bKST2SPAxZVkajAhY2RVgtKMv4TnwIoyK6auUFpWWKxD+VfINPYXRF4tDEZTc7GuvAkHQsg5+ctZYJUCKaimAGLPYOMdovtHkA20/fi2iHi6cusUs8Fvj/LRaEXBmB0b3V+G85Y9gHjXvIgpeoPZMybpEeVS2cdpHUr9OU+g5rfGza54GL1lOe+9bH7lTDrXuBph7Tm5TeN7Z3BFegef2Hnhw8YHpTklptdPqqYa+YWts6GDfBCHADaHdc334kQZeydUcd/UmJ0phefS70Uzkm5JAeiMMrJGomNnsWKNKHicNfsbEKPj/UJfu5BApbnHl07BWpC58BC8TNJQH9zLa6Ikv40FNaoWtjVlH436WFnfeGLDP+ffKI8sKmgKqCAcdICaskwVf+pqC+mstw0nF0pUZDdwmGOe8htPdfTIBasgajiBIcKIqnJkgw8m1wlWMteean0cZABHJkLrQLnQ2iA68dju23jS9pkHrF8v5hs9HccRBeO2+4Lq9OnyM9xfRw/Dcu+KDC2TVa+IKGnLALKuamW7z7ce1xeCtn/NRm5wlt2K+4SQuhyEds8R90zEeE5TP2lakckVYtzWNqkmxWzcUkWaVNwgGaCW6/Dykf\"}"};
	private static final String BASE64_PRK = "LS0tLS1CRUdJTiBFTkNSWVBURUQgUFJJVkFURSBLRVktLS0tLQpNSUlGS3pCVkJna3Foa2lHOXcwQkJRMHdTREFuQmdrcWhraUc5dzBCQlF3d0dnUVVOa0pka242WFBsRXM5WTRmCllvaFlpSTd3U3hJQ0FpY1FNQjBHQ1dDR1NBRmxBd1FCS2dRUXFvSjNHaEo1KzM4V2VNeTc3TndTbXdTQ0JOQ04KcGlSTzdVQUNuUVh3SGdZZGFva3N2YTZ0TlVPa2RWRk4zQVdjaVRnR0V0SzVPekF2RU1Ba25TZGtnTjQvTjNCYwpBNWhGZVdURE9USzNScGhCR2JzYmgzTFZoQ21KU25VN3grM3B4dVFSSHMvMm5BZkpyZHRWSE40aUpJbjZ6K1BXCmxNOU5ZaHVJTDJicndkZUNCdjdLbnRrWVFWa0lCdlZ1ajg3RFU2M3JQWFNPdXFzaHJhZ3pJVW5iUitaRXZJOXEKOUYyZTI1SHVFMEh4cTk3RC9QcWJiWkdkcXdjeHAzZitOQnhtZnhjWkdadWU2OWRHbjRJZGtpeGNjRUJNbnF6SgpTUUV0Vnk0MnVnZERFN3c4d2RMbVBwaU53MTcvaC9TRldWZUllU2c3NVYxL1YvbEVFTjNacCthVi9KRlJZaTNRCmxtNmpuVjc2d2ZRR0JZNmV1SWJ5MGdCRTA3NEx3aVdVVXFKSzRkcnNOSTZpOXZadDdOOWt2dmloM05kMFJpcTkKZUVWeFhNVGtHbk5aQUlvazlYVE8zZzBTWFB5YWIrRkVzYWxCRW80OUYxbFhWMXBwcEJtOUdEa0ZFQzB2ck5XSgo2QlZRakhCTnpZYXBKVDhmWk1EbnZ3d2xzZ1BjdTVONmhOMEVrTTNmUWFIQkY3UmtZWDIrdUZKUnYxWFpJYldoClRpMmtZeUFJbXJWNVNqd2V3UktYSHpPbS9NUE43aEd2V3hVRTR5S25Xa0kwcWYrRHR3Tm1kb0ptNlo3bFlqTzAKbk5TTEZMN3ovMncyK1pTVDVpbkt0MXYwV1dUbkJLSmEwazZhdUtTTyt4MnRGOEdiU0FKZWVZUExSVll0bVVXUgo0NEVsS3hwakZ6dTN3TVN3QjNML0NNSEFXZEx5NE9Gd1B2K1ZtNUpwVFU3cDh6S2dTaEcyYWZhS1lGMnJKNjA0CkRKZy9oUWxVM2hFUDhEMW1qcFF5eFhlVE9YM2Qwb29ka0dRcDhacXd4UTMxNWQwd2ZnUnk0WUdISU1tdytpdVUKV1RNUHh4L3MwWEFjbXhEQS9EVWQ4d2dzTERrWS83cVkvQUVTd3dhZ1kxN2huZGNHZ29SVVpFdTF5UVhIQjR4NwpGOGZsbU0wYnFSWUJXd0ZZT0dVT1VTUFY2NnZPNUU1dnA0Y3JZcUJmN0VSeDFiZi9TbXdVOGU3Vml4UDFwUmhpCjJRTGFkSng5WTZMYzJzN3Jnc1JteHFvUm5rRi8wWVhuWDloczcwVjRKbWQ4bEJITFJIZ3Btdk5rekV3ZUxxSUUKYnFMcWl2L1hCVlRXUnJ1ZW5JcWp3WnRSZzZpWkVEOGQ5MUpIZDluaGdXZmdhclZpSjRLT3JldjFtenV6Z3VGbgo2QnpUV2txQm9tUGFHVW9hWGY2MVUxelJtUkVVQ3Q0OFExNWJHRFVIblFxbzRJd1lFN2l6S3daMWNPQm5XTGdLCmtiaDY1U0laQmFSa2FOTG96bzllei8vbXNRTmY2T0J4ZE1ha0Q0RDR4b2hkaTNzL3Y2TmRheWYrYU5EZkppNDQKRUJxNUY5bEVwNmlscGgvQThEWVFxNnh0SmJURmNqWGg2bjI4TFlmYU15QllydDVPakhlNHhDQnh1aFR5NGcrYworQ3NxTWhxUFBCQzhiRUFuWDlLSS9FWmxOVHdWS1VzeFZlRmhmWEJGS09udXk2VklHbmJEVlZTS3BpeHI4bGNOCm1KTEp3OFRtQUJJT292eTFEUXhIc0FwbzdDa1JSeXRtMytMYnY1Z2cvS1dJWjV5TWJ6SG1RTUlUa3pqcDBXVTUKcndhblZuVnJ5THE1KzVGZk1vQ1Bvb1htYWtEOUI1N0ZLbll4U3cxbDJQR29QNnpoQmFNVlJhZ1Nqc0VzdVNVYQpsYXBGZEFUUC9ZK21pMGRXMnVSZ3BmeUZDeDNyWE80SkhLQis4WFZ0TjZkTGZWc1RVemRkRHlRL1ZJWnVpcUl4CkFFeVJQczdZa1ViRXhjRFBna1Nnbys5YWNmcUVBb3lFK21CK0xJRlJ1OGpUV09wZExqb0pqcUo4bEFVSWRLVFAKaWxiNkhjSHl3M2l4b2RLdGszTVhHS0hwVXVqYys3d0p0MmJQSC93M00xWGd0S2F5K2xhcWh3K29TN3pNQW5TVgphR3lYQjhDem45T21ubVVJRzhhS2FBMnphNUNlbDdHNXU3VUthUjQ1UWc9PQotLS0tLUVORCBFTkNSWVBURUQgUFJJVkFURSBLRVktLS0tLQo=";
	private static final String AESP_RK = "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";
	private static final String AES_BASE64_PK = "VTJGc2RHVmtYMStHT3R1TWNTK1IrdWQzUTBrV1RRSWZ4WXpvSFp2Sk1iS3E3dVFwWjdpRTRVMHFtZnIwWXMwWGRreFE5Ym02OVFKbldjNVA3RzcrOG1SOGtLWGkvOFhDSHJNdlZDZjM5L25Xb0M5MVhwR3ZheFZhUVp1VTVtZVVnZkZiWDY5aXpuNG5hVXFxdmEzZFdOYm1FVHZSNVNyM0QzSzBUVy9KUmhyMTZzWW9YUmc2RkFhZFJCcDNkdEVWeG82K25tWUticWFnNTAvV2hkajVNUjFEYUlMVlR1TGZ3SFlkaGdlWFhmTlhVNHMxOHZobWptV2JuTHF5S1VGeXA2YTdNb3pWbVdTdDkyemNqUERQWlg5YjBHMVdsUnJoNkhnMjJUK0FpV3h5WTFvM2Z2MTlwNGdkWFpIdzZib2FoMWxkcUg4d0w5bkV1NktoRlRJQzdhcjRET3RicHorcmprSUgvd01BOG9GTERiRHVuOEV2MDdITEVDQjdkVUJtMHEwWDZ5WFBkenpmZThpSmxwajBMNDQ1aTZPRWl6cEFCeFdJZU1sc0djODVsdTdUMnRROVRXUlRUUWpobjQzcmlBUWZJNWJCSGhVL2FCZUFUdkJNWkk1ZSs5VWovZktoUkRZVFE1WDRydmw0RGViQlFMN2NhNnFRNEVVbU9HV3VlU2NlMzdUSHF0S2FVTTFTTXYyaWNJbGZ5TFk4UXlLdUdHby9aWkRudkhZNXZYRVhkRUFBYllZU3puSnhQSTI3ajZYMG9EbW9HUnAvMnFUV1kxOExHTTdZUVhmWFZGeUdZWmtvVThBMi80bW9kSzBlNkpiUVBRTWhrWjZwZzdhT1dBMGViOGRqb2gxaEU5R3RXZDR0MHNySWttZ29kUDRRRDQvYzlObEtudmZjQjRuUUMvUFFpZnNhS0c1aGZJcHYxVXB0NUROVzV6TUlwMm9rWHdZMnNrbWdSbVQ0QjJka0pjQ3IrWStBMUNLMkFYSjFQVEdwVWlyR0xmYm9zVTF6NlBaaGwzWTFLRkpWSU92eWhUNDJkOU42QmpDVFVJTWFSUkxtbkxyVVIvb3pva2F6clAwdjBmUDNvSlBMQjhncDBuSDhtdFp5VC9aaUxWaXoybW5MUkRXL0xuTFNDWWt6R0VaWEFGcjBLbEZpRmNRcUF1eTNTQ2IvTVYybnJaQ1ZtWXBDQ3JEUnZJcVM0cHphMTcrYjIvKzlEcFI2SFNvNTlka2k1d3phNU1sdUV5eTBOTTlSNHR1SzM1SVJsOHl2N2x3Q1FtdDVOdVBWSGNYRG5xdituLzI3ejVWTG96aDFzSTZ0Uno3MnVBbUdCUDVSNThGaWtjVnN6SHlEWUlza0NWdWVmT3FidEtYZzg4dFpZWmhGNXVyUktBQnFpTlRQS2ZRMDNTek1HMnRiYUxkZDQwdUhkRkxPUklGN0RidjVrN3k3MTVETzk4bzBWMEt0Yk0zSnhQZGVYRWVsaGljTVJEaDJHeE9BR1pTZDBqL0pRM09UTXFxekZMa2pvRkVNVnJRTWFpTmtHdEtuajRhZGo4Q0JWUjluaWdITUpTVW1wTm9xdmdpNGphUDlZdUJkMHZNdElQbEF4SXBCajIyWDJuem5kOWU2ZkhGVGZua1VKanRkWGt3L25MeXN5cUoxTkd6cVdldDdBYlNwUmtFbEYzVWZKQ2phczIvcHQrdGNhTXFuSGFKMjJ2N0JWZ0thbWlaQlp1L3NKSDRIdVRCOHkwU2xNY0xCRTU2bEpFamtiV3ppK2I5WXRXcGl1NTU5aWZTa0xQQ3VVN1F3VEFndkJBWHdiTGxkc3V2Nm1CdUxtVTNJK2dtYUhlOXBvWmlYc3VYdUd4cERzYnBLQTg3Ujd0cHYvOTNCSSt2dkFBTE9DeVplV0MxckgvZWlnMUtsdDJxSFhEYjZweFRjckhxQUJONWlZWWdqNk5kTjY5RC9URTNHVHZZUTgwVU9haGFiZGVWQUV6SXhSRXVuZ3l6ejA0S3NEWEI2QWl4aGh4K2Iyelc4WHpsWmVielBuVFFaSG5OTmZBMm1BS3BYNFJLNXRhL0hXQUt6V1V5dTBGV0s2TnJjaVgySXdCbWNaaHR5WXJOdUpiWWlHRlY1UEEyK2hVN3JCWkpkOHgyaVpCempmR1h2bVdMdkNGc2VWRzlsV2NlNktPNUVlU25zdk0yYkczYlNMd295c04yYXp3Um5CYk5uWE5rWk1IRUZTTXJQY3puUlNBWTgvc25PRm9rYWRBOE9Ed1V4VHlkTGZadm5RM2xLSnkyczZFcTM2NWUzU2lSL2cxY3BrWVEweVd1MVVqNFhNMkdLdXZLYlVjSFR4MnpjUVBPdTZiK0JKcGFrNGRYeitVNGpIeDgweWJoOWgwTEZsWVR3ZWkrMGhvTHZhRHh2K1ZTMDFYb1ozbnl0OUFKQVJOaGt5YXFsMXAvSXM5ZjlZelZtV0JTbTg1UllEd3hBenoxNHZ6UmxXV0Z1U0dpb1F1NldVa3FQdUQvSzlIalY0dG1zdWwxNUwyUUhPNkhXeU5tUVhpWVlhMVpPZ0R3aW16elJCRUxNbUhYZDloUWdRZEJvR1FXUWxmSG5hMXNESEx4MmFlTmhjUU1FcStmMjZjOC9QT21pRVJpMXJ5NktubGNvMTRzOHZzMWpZVTRiQ1B1SU54ZElIcEFyL1MvUnhGL0U3Njl0aVJhV0lqNUdFNUJZcmJtQ0J3M3cvYmp1V0hvSnFWamZreWdpYkc1a2VHRVIzYngzeU1lRTNNOFVHb1dsUzFPQktDa29PanNYU3FSWjNlREY5MHgrbE5wU0xPVGJGeWJFUWROcnBKWXRYWG8xajZIbnVsdTFOdU42UHJUOURSQmhhMjBTUlpCLy92ZXNHRkJjL0VOT1JFSWR6YzBLRlNkdHVYM0ZBTUVhVUl2VU9WaUZSdlBQOGltSldDRW9SK3JCOUQ2NUx0bjRRcjZCVUdvNlRMK1lzdkk1ZWRabTBURGJyYXR6VkNDSzBDckxic2FNMVQ3UDV5QnNVUHdEc2NLVHgyQUlwcDRrdFNmdDBQU0Nteml3M1R3S2pDVXBzYU9CRGlqQ0VvUmMvd09tc2FzcUJwL2ZZTGFKWUs1TWZVeHpqeXhhazlGYmtvWnBKVjVmRVRROE9DSTNsS2dzQXlHOWdQaUl5NFhXendCQ0o4YUpjY0puamhIOE9xTXc4dmJXYVdyTVdwNXJzY3ZwRTlNb1NUNzdyMms1Y3JCSFp6MG9hNGxvYmNoS20xd2tyUXBWZGhtbTlhWFBjYm96eEhKbnhvQ094TmJmMmRhWjVpOWpJVzlhY0cwVzUzNURaenFYSUZmWk1hd09BdzFxQ3NORWUyRndibGkvclgzek04K2hQVTh5WW9zSWdrNlBNVFFkSTFLb2pwS3c2RzhuK1k2cEl4Q3BvVTYyTllDNTYyUnptYysrSXRjVUM0N3ZqTUdLM2RJUnJoK29xMnFzekFYOGRsL3pNam9rTlNVRVhISXVDK0txbzZ6bVF1YVk4aW1XYnBFR1c3UGloV3NnVm1odGpmM3hvSHRpaWphaXhlbnpoSDR4ek5CQ2tWQ2txVTRqbkpCOVpacHVYYnRUUjhUTmZ3eFkvMVJhdUwrUFhjcjJES0NqaktlWURMMTVER1BwYnhoZEMxQ3EwRndnVzNpVkF6ak4vMm16eVpLUlNJRS9BLzQ5MmRPa1d5UTVtcDFyWGk0UE1obURHakczYVkxeGxlNEh3L0xsMW5XNjVsZUlRTUNmZVJyamtwTFdBQkE0WHpTaGE2UzJZb2s0YTJ0VXlVdXVpSTFaWENpRjlRaEw3MVZNa21ENytES3A4VG9jalk2QzRCdUxuUEU0NFVsVlJDdjR6VWV3N2Q5ekpFLzFKME0zckdyOXJwWHVwWGhUbDhXaDZKazJlNThTb1dvdUxrTXc4MWdFeUZHOFRSTTcvMXVtNzlibDhNWndNWGZWaXRQaFlhSzZkTmJMUzFTVXlkWTZ1amN5UkdOUENzR2pMOExobUNnanlVbGhXajVLWnhDUE5sM1NKLzkzSHBleUtJdGw2ZWxwZmwrR1hBZDFqR0Z1SUttWTI0ODF4S0ZVNFlaazYwektSMWh4TWRuTTkwamJRUjYxMjJlbTc2YlI5UkJSd0JpZVZZMURaOTk5VFA5Y0xFUjhWcDlHZCtoc1VRZVVqS003Uk1Pak42cGZTMldENktKb2RNbERoVVY4Tm03YmlHUEtyRUVTblR6VkdpV3FxN3RnWGdYdVpZU09zTHQ5TDlvZ2Z5aWtaWldSSEsvdzU2NlJ6ckkrdGkwdHlCV1Q5NGRQdUF6eHRNZWl1QWM2aTczbS9UeUwweCtUSUlmaElWZGJGRHYzQjZKVzZZQ24xck1xZG5xd2djek1uMXNCUHdVTHdWR2o2T2pBL1dpdnQvckdCMk45ZkplS29LcVZPeWMvVTYrWE01cGlvSjB0aXV0WHFsYWJUaHFKbTZOSStIT1JzeHplR3JFejlBYkpNV281clBjaUl3NVRveGtwbU9WOXYwamZyTHNjTTduTkxOOVdHTmdvSFdwWnlDemprREtNUWlRSm9Eay9IekpMM2dnakZkMmlBTzJKQ2FQZm9wTHppU2l0bXQyMkROM3czWDJmd0p1KzdVOTAyTnlSdXVWK2IyVWZvT2hSRysxWUx6YlNrWXh0V245ckpBT25qaVhKa0h5WFBCVVYxTEZvS0NnbXVtU2tCaWErZVVYdkF2dmZlRkJuZ3ZjZWMzZnk4NCs5VE1mcXh2c290V0JEeEgwWmc5U1hiRkwwNnNPTVV3S1A2dTVmY3lyaTNtc1F3MkdsanFRSFVZRDNPUEpJTitCb2VrV2RPY2ZNME9SdzFwb0R0U085VFJXdCsvb3orYzdpbG5IdVlseWErR0s1dDVEdmQ5NVhWMllrYkhKZmp5QUNTWXRJK3hNVk92YklmdExlZnlQeGZzYXdUUHl2ZDRWbUYxZ1RJSzUvNW9KSGFCcXZsVnJFZ0I3Q2xxdEpBWmZSbHRoSE5aUzE3dk9vQk1YVlhmUlAxVm9ZR3RiYUlBQXdCTFVmVDdTM1RpcmxJZzM2Nk1zbSsvZWdaekdxWnJobGVCVXM0elpHREJQME5tMmNFRFE2TTZ0N05EYmVtMWFPLzVYWGRlMjk2WWQ1bGNFNjVRamhaai9TOStOb084TnBNcDRvTHNIQ0NDbVVmaWFBeGNRTXowWWh1WXFyMDRYMi9waER6WllnOEsrbU9MZU90bXVlM21adTlVK0lFTVlEMFJOcmZOOTNKMngzSWdYVEJ4dHRwcjF2T3liUENQWDRCQkJaWkhkWWJCTC9hSldZMElPZ0RuQ1dueGpUOEFTU0h2dGtrODFDWUgxYUx2Y1cyZVZwYTRrdjRxRHVabmpFZW1JbUlUSURZbENlTjhFNlgxTUxzQnY5L3lWWlZkZjhpSFRtSG5QOHh6RU1PZ0ZvazFFeTRCZ0w1cytpY0d0VXFWNWUvMVlvYzBZWnNrZUpIU3FkZlVGeWc4V1N0cXVIeG1IeFNJbGN5RXJ4ZEdrY2ZaZU5MeTdkUzJ4d1l3MXZPY3h5TjRWUDVpVGwycDdGc05qaDV0WnhhcGlFQmdrZVNZMkR5Z0t2ZjkvdllldmNXZzNsNTF1MFMzMi93YXRwazZtMVZtazExWFdWMmJIMXl1VllkM01JbUJRajgrR3dxdHdjTzZSVTJyZnpORnc2ZFVHVzlCdWpDTXIya2RNckVlaHZZc1QwUjZuSlR3SHNybThGUytBOVNyU3JEVDV4TmZKYjZYMythWGthK1FLSkJIOWR4NFRneWtCb1hQRllTYUdJalFnSkI2QW5PWVY4OUMzTy9GV01LYlBE";
	private static final String PU = "-----BEGIN PUBLIC KEY-----\nMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAs6VD71P0k95SsJ953sue\nq8u3e8LpqzkN6TyR7YO1tf75SmUJDPkQsogJl0gENLvuU3pZXOXt3VF6oKX350ms\noGseXEpeLi9cnq0tTqAsixfW7YuVLEsEwizetaPkQPydbDc5t4W2yUE1srgCaoMB\nLZOfGX/0nsIXuxu+A8gkEygldpDTuHLW/ckxMsQfcSN1IW1Ku7saUhf58Nt89LAX\nDtLGoWTMVt2WdDUGzL/qLWMgi1eIc8GUESWatntDAHSlwfDfhICBLip3K8uYxVJ+\nvN91xkfVNo/0bva2CczPZwjOLlO203CU6ZmpjT0Mu0Pvf95M9qE/Z4m9oM7c9xlf\nC5n33Vz9luwq+X0fd0ORyef+b9gbpkwN99GSkM1gfNeMvgbGapEZV0MKfUEFA/5y\nbKyZrfq3mamTCamjZV5OJH/tWdIgPzQEuwG/l8DKUcNtv8xHLg+LxmVr5ffFKEht\nLzXtSJTQss9DnStft+wZBlTUbDR1eX5Aw4ZX69KfKnTvU/2XfOTfFjqH2I83/SCe\nrecp/NQJneg2QQKlgWg5tSv1SdEewYzyItQxav52U+TcFiSk9IZi5moovyDcYOHw\nysdbjsTNB6F+Vmg3rmqSbGWK3LvHUasPRRte9/NbpwxzQLuXub0qxVzSLm9gufFu\n+qPnGROafgdv/Vy31h4zfGMCAwEAAQ==\n-----END PUBLIC KEY-----\n";
	private static final String PK = "-----BEGIN RSA PRIVATE KEY-----\n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\n-----END RSA PRIVATE KEY-----\n";

	@Autowired
	JdbcTemplate jdbcTemplate;

	/**
	 * Create initial test data tables and entries
	 */
	public void createDatabase() throws Exception {
		logger.info("Creating tables");
		jdbcTemplate.execute("DROP TABLE securenote IF EXISTS");
		jdbcTemplate.execute("CREATE TABLE securenote(id SERIAL, title VARCHAR(128), note VARCHAR(8122), fkey VARCHAR(1024))");
		jdbcTemplate.execute("DROP TABLE key_pair IF EXISTS");
		jdbcTemplate.execute("CREATE TABLE key_pair (id SERIAL, public_key VARCHAR(8192), private_key VARCHAR(8192))");

		logger.info("Inserting data");
		UserKeyPair keyPair = Crypto.generateUserKeyPair(UserKeyPair.Version.RSA4096, USER_PASSWORD);
		UserPrivateKey userPrivateKey = keyPair.getUserPrivateKey();

		String query = null;
		for (int i = 0; i < 3; i++) {
//			query = "INSERT INTO Keys(ctype, cvalue) VALUES ('" + KEY_TYPE[2] + "', '" + "FKEY[i].getKey()" + "')";
//			jdbcTemplate.execute(query);
			query = "INSERT INTO securenote(title, note, fkey) VALUES ('" + TITLES[i] + "', '" + NOTES[i] + "', '" + "key" + "')";
			jdbcTemplate.execute(query);
		}
		query = "INSERT INTO key_pair(public_key, private_key) VALUES ('" + PU + "', '" + AES_BASE64_PK + "')";
		jdbcTemplate.execute(query);

	}

	private void generateFKeysAndNotes(UserKeyPair keyPair) {
		try {
			for (int i = 0; i < 3; i++) {
				PlainFileKey fileKey = Crypto.generateFileKey(PlainFileKey.Version.AES256GCM);
				byte[] plainData = CLEARTEXTS[i].getBytes("UTF8");
				FKEYS[i] = Crypto.encryptFileKey(fileKey, keyPair.getUserPublicKey());
				//NOTE[i] = encrypt(fileKey, plainData);
			}
		} catch (Exception e) {
			throw new RuntimeException(e);
		}
	}

	private byte[] encrypt(PlainFileKey fileKey, byte[] data) throws Exception {
		FileEncryptionCipher cipher = Crypto.createFileEncryptionCipher(fileKey);
		ByteArrayInputStream is = new ByteArrayInputStream(data);
		ByteArrayOutputStream os = new ByteArrayOutputStream();
		byte[] buffer = new byte[16];
		byte[] encryptedData;
		int count;
		try {
			EncryptedDataContainer eDataContainer;
			while ((count = is.read(buffer)) != -1) {
				byte[] pData = createByteArray(buffer, count);
				eDataContainer = cipher.processBytes(new PlainDataContainer(pData));
				os.write(eDataContainer.getContent());
			}
			eDataContainer = cipher.doFinal();
			os.write(eDataContainer.getContent());
			String tag = CryptoUtils.byteArrayToString(eDataContainer.getTag());
			fileKey.setTag(tag);
			encryptedData = os.toByteArray();
		} catch (Exception e) {
			throw new RuntimeException("Error while encrypting data!", e);
		} finally {
			try {
				os.close();
				is.close();
			} catch (IOException e) {
				// Nothing to do here
			}
		}
		return encryptedData;
	}

	private byte[] createByteArray(byte[] bytes, int len) {
		byte[] b = new byte[len];
		System.arraycopy(bytes, 0, b, 0, len);
		return b;
	}
}
